dataset_formaty.eps
select f.nazov, count(df.dataset_id) from format f inner join dataset_format df on df.format_id = f.id inner join view_dataset d on d.id = df.dataset_id where d.zverejnitelnost in ('zverejnitelne', 'ciastocne') and vyjadrenie = 'suhlas' and elektronicky in ('ano', 'ciastocne') group by f.id having count(df.dataset_id) >= 4 order by count(df.dataset_id) desc;

zverejnene_prevadzkovatel.eps
select x.prevadzkovatel, x.cnt, y.cnt from (select prevadzkovatel, count(id) as cnt from view_dataset_wide where zverejnitelnost in ('zverejnitelne', 'ciastocne', 'nezname') group by prevadzkovatel order by prevadzkovatel) x inner join (select prevadzkovatel, count(id) as cnt from view_dataset_wide d where exists(select * from ckan_dataset c where dataset_id = d.id) group by prevadzkovatel) y on x.prevadzkovatel = y.prevadzkovatel;
